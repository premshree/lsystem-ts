<html>
  <head> </head>
  <body>
    <canvas id="canvas" width="1000" height="1000"></canvas>
  </body>
  <script src="../build/l-system.browser.js"></script>
  <script>
    var canvas = document.getElementById("canvas");
    var ctx = canvas.getContext("2d");

    // translate to center of canvas
    ctx.translate(canvas.width/3, canvas.height );
    ctx.scale(-1, 1);
    ctx.rotate((Math.PI/180)*150);
    ctx.lineWidth = 0.3;

    var hilbert = new LSystem({
      axiom: "A",
      productions: {
        A: "lBfrAfArfBl",
        B: "rAflBfBlfAr"
      },
      functions: {
        f: () => {
          ctx.beginPath();
          ctx.moveTo(0, 0);
          ctx.lineTo(0, canvas.width / Math.pow(2, hilbert.generations + 1));
          ctx.stroke();
          ctx.translate(0, canvas.width / Math.pow(2, hilbert.generations + 1));
        },
        l: () => ctx.rotate((Math.PI / 180) * 90),
        r: () => ctx.rotate((Math.PI / 180) * -90)
      }
    });

    var plant = new LSystem({
      axiom: "X",
      productions: {
        X: "F+[[X]-X]-F[-FX]+X",
        F: "FF"
      },
      functions: {
        F: () => {
          ctx.beginPath();
          ctx.moveTo(0, 0);
          ctx.lineTo(0, canvas.width / Math.pow(2, plant.generations + 2));
          ctx.stroke();
          ctx.translate(0, canvas.width / Math.pow(2, plant.generations + 2));
        },
        "+": () => {
          ctx.rotate((Math.PI / 180) * 25);
        },
        "-": () => {
          ctx.rotate((Math.PI / 180) * -25);
        },
        "[": () => {
          ctx.save();
        },
        "]": () => {
          ctx.restore();
        }
      }
    });

    var sierpinski = new LSystem({
      axiom: "F−G−G",
      productions: {
        F: "F-G+F+G-F",
        G: "GG"
      },
      functions: {
        'F': () => {
          ctx.beginPath();
          ctx.moveTo(0, 0);
          ctx.lineTo(0, canvas.height / Math.pow(2, sierpinski.generations));
          ctx.stroke();
          ctx.translate(0, canvas.height / Math.pow(2, sierpinski.generations));
          ctx.closePath();
        },
        'G': () => {
          ctx.beginPath();
          ctx.moveTo(0, 0);
          ctx.lineTo(0, canvas.height / Math.pow(2, sierpinski.generations));
          ctx.stroke();
          ctx.translate(0, canvas.height / Math.pow(2, sierpinski.generations));           
          ctx.closePath();
        },
        '+': () => {
          ctx.rotate((Math.PI / 180) * -120);
        },
        '-': () => {
          ctx.rotate((Math.PI / 180) * 120);
        }
      }
    });

    var sierpinskiArrowHead = new LSystem({
      axiom: "A",
      productions: {
        A: "B-A-B",
        B: "A+B+A"
      },
      functions: {
        'A': () => {
          ctx.beginPath();
          ctx.moveTo(0, 0);
          ctx.lineTo(0, canvas.height / Math.pow(2, sierpinskiArrowHead.generations+1));
          ctx.stroke();
          ctx.translate(0, canvas.height / Math.pow(2, sierpinskiArrowHead.generations+1));
          ctx.closePath();
        },
        'B': () => {
          ctx.beginPath();
          ctx.moveTo(0, 0);
          ctx.lineTo(0, canvas.height / Math.pow(2, sierpinskiArrowHead.generations+1));
          ctx.stroke();
          ctx.translate(0, canvas.height / Math.pow(2, sierpinskiArrowHead.generations+1));           
          ctx.closePath();
        },
        '+': () => {
          ctx.rotate((Math.PI / 180) * -60);
        },
        '-': () => {
          ctx.rotate((Math.PI / 180) * 60);
        }
      }
    });

    var dragon = new LSystem({
      axiom: "FX",
      productions: {
        X: "X+YF+",
        Y: "-FX-Y"
      },
      functions: {
        'F': () => {
          ctx.beginPath();
          ctx.moveTo(0, 0);
          ctx.lineTo(0, canvas.height / (dragon.generations+100));
          ctx.stroke();
          ctx.translate(0, canvas.height / (dragon.generations+100));
          ctx.closePath();
        },
        '+': () => {
          ctx.rotate((Math.PI / 180) * +90);
        },
        '-': () => {
          ctx.rotate((Math.PI / 180) * -90);
        }
      }
    });

    //cantor.produce(4);
    //hilbert.produce(5);
    //console.log(hilbert.getString(5));
    plant.produce(9);
    //sierpinski.produce(5);
    //sierpinskiArrowHead.produce(8); // n=8, rotate canvas 270
    //dragon.produce(10); // OK
  </script>
</html>
